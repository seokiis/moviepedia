{"ast":null,"code":"var _jsxFileName = \"/Users/kimseokhee/Desktop/moviepedia/src/components/App.js\",\n  _s = $RefreshSig$();\nimport { useCallback, useEffect, useState } from \"react\";\nimport ReviewList from \"./ReviewList\";\nimport ReviewForm from \"./ReviewForm\";\nimport { createReview, deleteReview, getReviews, updateReview } from \"../api\";\nimport useAsync from \"../hooks/useAsync\";\nimport LocaleSelect from \"./LocaleSelect\";\nimport \"./App.css\";\nimport logoImg from \"../assets/logo.png\";\nimport ticketImg from \"../assets/ticket.png\";\nimport useTranslate from \"../hooks/useTranslate\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LIMIT = 6;\nfunction AppSortButton(_ref) {\n  let {\n    selected,\n    children,\n    onClick\n  } = _ref;\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    disabled: selected,\n    className: `AppSortButton ${selected ? \"selected\" : \"\"}`,\n    onClick: onClick,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 9\n  }, this);\n}\n_c = AppSortButton;\nfunction App() {\n  _s();\n  const t = useTranslate();\n  const [order, setOrder] = useState(\"createdAt\");\n  const [offset, setOffset] = useState(0);\n  const [hasNext, setHasNext] = useState(false);\n  const [isLoading, loadingError, getReviewsAsync] = useAsync(getReviews);\n  const [items, setItems] = useState([]);\n  const sortedItems = items.sort((a, b) => b[order] - a[order]);\n  const handleNewestClick = () => setOrder(\"createdAt\");\n  const handleBestClick = () => setOrder(\"rating\");\n  const handleDelete = async id => {\n    const result = await deleteReview(id);\n    if (!result) return;\n    setItems(prevItems => prevItems.filter(item => item.id !== id));\n  };\n  const handleLoad = useCallback(async options => {\n    const result = await getReviewsAsync(options);\n    if (!result) return;\n    const {\n      paging,\n      reviews\n    } = result;\n    if (options.offset === 0) {\n      setItems(reviews);\n    } else {\n      setItems(prevItems => [...prevItems, ...reviews]);\n    }\n    setOffset(options.offset + options.limit);\n    setHasNext(paging.hasNext);\n  }, [getReviewsAsync]);\n  const handleLoadMore = async () => {\n    await handleLoad({\n      order,\n      offset,\n      limit: LIMIT\n    });\n  };\n  const handleCreateSuccess = review => {\n    setItems(prevItems => [review, ...prevItems]);\n  };\n  const handleUpdateSuccess = review => {\n    setItems(prevItems => {\n      const splitIdx = prevItems.findIndex(item => item.id === review.id);\n      return [...prevItems.slice(0, splitIdx), review, ...prevItems.slice(splitIdx + 1)];\n    });\n  };\n  useEffect(() => {\n    handleLoad({\n      order,\n      offset: 0,\n      limit: LIMIT\n    });\n  }, [order, handleLoad]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"App-nav\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-nav-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"App-logo\",\n          src: logoImg,\n          alt: \"MOVIDE PEDIA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(LocaleSelect, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-ReviewForm\",\n        style: {\n          backgroundImage: `url(\"${ticketImg}\")`\n        },\n        children: /*#__PURE__*/_jsxDEV(ReviewForm, {\n          onSubmit: createReview,\n          onSubmitSuccess: handleCreateSuccess\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-sorts\",\n        children: [/*#__PURE__*/_jsxDEV(AppSortButton, {\n          selected: order === \"createdAt\",\n          onClick: handleNewestClick,\n          children: t(\"newest\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(AppSortButton, {\n          selected: order === \"rating\",\n          onClick: handleBestClick,\n          children: t(\"best\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-ReviewList\",\n        children: [/*#__PURE__*/_jsxDEV(ReviewList, {\n          items: sortedItems,\n          onDelete: handleDelete,\n          onUpdate: updateReview,\n          onUpdateSuccess: handleUpdateSuccess\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), hasNext ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"App-load-more-button\",\n          disabled: isLoading,\n          onClick: handleLoadMore,\n          children: t(\"load more\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"App-load-more-button\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 25\n        }, this), (loadingError === null || loadingError === void 0 ? void 0 : loadingError.message) && /*#__PURE__*/_jsxDEV(\"span\", {\n          children: loadingError.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      className: \"App-footer\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-footer-container\",\n        children: [t(\"terms of service\"), \" | \", t(\"privacy policy\")]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 9\n  }, this);\n}\n_s(App, \"I9YKMvc7Z58jQQarf+vhu3NLDLU=\", false, function () {\n  return [useTranslate, useAsync];\n});\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AppSortButton\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["useCallback","useEffect","useState","ReviewList","ReviewForm","createReview","deleteReview","getReviews","updateReview","useAsync","LocaleSelect","logoImg","ticketImg","useTranslate","LIMIT","AppSortButton","selected","children","onClick","App","t","order","setOrder","offset","setOffset","hasNext","setHasNext","isLoading","loadingError","getReviewsAsync","items","setItems","sortedItems","sort","a","b","handleNewestClick","handleBestClick","handleDelete","id","result","prevItems","filter","item","handleLoad","options","paging","reviews","limit","handleLoadMore","handleCreateSuccess","review","handleUpdateSuccess","splitIdx","findIndex","slice","backgroundImage","message"],"sources":["/Users/kimseokhee/Desktop/moviepedia/src/components/App.js"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport ReviewList from \"./ReviewList\";\nimport ReviewForm from \"./ReviewForm\";\nimport { createReview, deleteReview, getReviews, updateReview } from \"../api\";\nimport useAsync from \"../hooks/useAsync\";\nimport LocaleSelect from \"./LocaleSelect\";\nimport \"./App.css\";\nimport logoImg from \"../assets/logo.png\";\nimport ticketImg from \"../assets/ticket.png\";\nimport useTranslate from \"../hooks/useTranslate\";\n\nconst LIMIT = 6;\n\nfunction AppSortButton({ selected, children, onClick }) {\n    return (\n        <button\n            disabled={selected}\n            className={`AppSortButton ${selected ? \"selected\" : \"\"}`}\n            onClick={onClick}\n        >\n            {children}\n        </button>\n    );\n}\n\nfunction App() {\n    const t = useTranslate();\n    const [order, setOrder] = useState(\"createdAt\");\n    const [offset, setOffset] = useState(0);\n    const [hasNext, setHasNext] = useState(false);\n    const [isLoading, loadingError, getReviewsAsync] = useAsync(getReviews);\n    const [items, setItems] = useState([]);\n    const sortedItems = items.sort((a, b) => b[order] - a[order]);\n\n    const handleNewestClick = () => setOrder(\"createdAt\");\n\n    const handleBestClick = () => setOrder(\"rating\");\n\n    const handleDelete = async (id) => {\n        const result = await deleteReview(id);\n        if (!result) return;\n\n        setItems((prevItems) => prevItems.filter((item) => item.id !== id));\n    };\n\n    const handleLoad = useCallback(\n        async (options) => {\n            const result = await getReviewsAsync(options);\n            if (!result) return;\n\n            const { paging, reviews } = result;\n            if (options.offset === 0) {\n                setItems(reviews);\n            } else {\n                setItems((prevItems) => [...prevItems, ...reviews]);\n            }\n            setOffset(options.offset + options.limit);\n            setHasNext(paging.hasNext);\n        },\n        [getReviewsAsync]\n    );\n\n    const handleLoadMore = async () => {\n        await handleLoad({ order, offset, limit: LIMIT });\n    };\n\n    const handleCreateSuccess = (review) => {\n        setItems((prevItems) => [review, ...prevItems]);\n    };\n\n    const handleUpdateSuccess = (review) => {\n        setItems((prevItems) => {\n            const splitIdx = prevItems.findIndex(\n                (item) => item.id === review.id\n            );\n            return [\n                ...prevItems.slice(0, splitIdx),\n                review,\n                ...prevItems.slice(splitIdx + 1),\n            ];\n        });\n    };\n\n    useEffect(() => {\n        handleLoad({ order, offset: 0, limit: LIMIT });\n    }, [order, handleLoad]);\n\n    return (\n        <div className=\"App\">\n            <nav className=\"App-nav\">\n                <div className=\"App-nav-container\">\n                    <img\n                        className=\"App-logo\"\n                        src={logoImg}\n                        alt=\"MOVIDE PEDIA\"\n                    />\n                    <LocaleSelect />\n                </div>\n            </nav>\n            <div className=\"App-container\">\n                <div\n                    className=\"App-ReviewForm\"\n                    style={{\n                        backgroundImage: `url(\"${ticketImg}\")`,\n                    }}\n                >\n                    <ReviewForm\n                        onSubmit={createReview}\n                        onSubmitSuccess={handleCreateSuccess}\n                    />\n                </div>\n                <div className=\"App-sorts\">\n                    <AppSortButton\n                        selected={order === \"createdAt\"}\n                        onClick={handleNewestClick}\n                    >\n                        {t(\"newest\")}\n                    </AppSortButton>\n                    <AppSortButton\n                        selected={order === \"rating\"}\n                        onClick={handleBestClick}\n                    >\n                        {t(\"best\")}\n                    </AppSortButton>\n                </div>\n                <div className=\"App-ReviewList\">\n                    <ReviewList\n                        items={sortedItems}\n                        onDelete={handleDelete}\n                        onUpdate={updateReview}\n                        onUpdateSuccess={handleUpdateSuccess}\n                    />\n                    {hasNext ? (\n                        <button\n                            className=\"App-load-more-button\"\n                            disabled={isLoading}\n                            onClick={handleLoadMore}\n                        >\n                            {t(\"load more\")}\n                        </button>\n                    ) : (\n                        <div className=\"App-load-more-button\" />\n                    )}\n                    {loadingError?.message && (\n                        <span>{loadingError.message}</span>\n                    )}\n                </div>\n            </div>\n            <footer className=\"App-footer\">\n                <div className=\"App-footer-container\">\n                    {t(\"terms of service\")} | {t(\"privacy policy\")}\n                </div>\n            </footer>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}